<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OAuth Frontend Integration Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-8">OAuth Frontend Integration Test</h1>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- OAuth Status Test -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">OAuth Status</h2>
                <div id="oauth-status">Loading...</div>
            </div>
            
            <!-- Auth Service Test -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">Auth Service</h2>
                <div id="auth-service-status">Loading...</div>
            </div>
            
            <!-- Component Loading Test -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">Components</h2>
                <div id="components-status">Loading...</div>
            </div>
            
            <!-- Navigation Test -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">Navigation Links</h2>
                <div class="space-y-2">
                    <a href="/" class="block text-blue-600 hover:underline">üè† Main Dashboard</a>
                    <a href="/admin-oauth.html" class="block text-blue-600 hover:underline">üîê OAuth Configuration</a>
                    <a href="/admin-agents.html" class="block text-blue-600 hover:underline">ü§ñ Email/SMS Agents</a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Load auth service -->
    <script src="/static/dist/auth.js"></script>
    <script src="/static/dist/AdminOAuthConfig.js"></script>
    
    <script>
        // Test OAuth status endpoint
        async function testOAuthStatus() {
            try {
                const response = await fetch('/api/auth/google/status');
                const data = await response.json();
                document.getElementById('oauth-status').innerHTML = `
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span>Configured:</span>
                            <span class="${data.configured ? 'text-green-600' : 'text-red-600'}">${data.configured ? '‚úÖ' : '‚ùå'}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Client ID Set:</span>
                            <span class="${data.client_id_set ? 'text-green-600' : 'text-red-600'}">${data.client_id_set ? '‚úÖ' : '‚ùå'}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Client Secret Set:</span>
                            <span class="${data.client_secret_set ? 'text-green-600' : 'text-red-600'}">${data.client_secret_set ? '‚úÖ' : '‚ùå'}</span>
                        </div>
                        <div class="text-sm text-gray-600 mt-2">
                            Redirect URI: ${data.redirect_uri}
                        </div>
                    </div>
                `;
            } catch (error) {
                document.getElementById('oauth-status').innerHTML = `<div class="text-red-600">Error: ${error.message}</div>`;
            }
        }
        
        // Test auth service initialization
        function testAuthService() {
            const status = document.getElementById('auth-service-status');
            
            if (window.AuthService) {
                const authState = window.AuthService.getState();
                status.innerHTML = `
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span>Service Available:</span>
                            <span class="text-green-600">‚úÖ</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Loading:</span>
                            <span class="${authState.loading ? 'text-yellow-600' : 'text-green-600'}">${authState.loading ? '‚è≥' : '‚úÖ'}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Authenticated:</span>
                            <span class="${authState.isAuthenticated ? 'text-green-600' : 'text-gray-600'}">${authState.isAuthenticated ? '‚úÖ' : '‚ùå'}</span>
                        </div>
                    </div>
                `;
            } else {
                status.innerHTML = '<div class="text-red-600">‚ùå AuthService not available</div>';
            }
        }
        
        // Test component availability
        function testComponents() {
            const status = document.getElementById('components-status');
            const components = ['AdminOAuthConfig', 'AuthService', 'AdminNavigation'];
            
            const results = components.map(comp => ({
                name: comp,
                available: typeof window[comp] !== 'undefined'
            }));
            
            status.innerHTML = `
                <div class="space-y-2">
                    ${results.map(result => `
                        <div class="flex justify-between">
                            <span>${result.name}:</span>
                            <span class="${result.available ? 'text-green-600' : 'text-red-600'}">${result.available ? '‚úÖ' : '‚ùå'}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        // Run tests when page loads
        document.addEventListener('DOMContentLoaded', () => {
            testOAuthStatus();
            
            // Wait a bit for auth service to initialize
            setTimeout(() => {
                testAuthService();
                testComponents();
            }, 1000);
        });
        
        // Refresh tests every 5 seconds
        setInterval(() => {
            testAuthService();
        }, 5000);
    </script>
</body>
</html>